{"version":3,"file":"author-cycle.min.js","sources":["../src/element.js"],"sourcesContent":["class AuthorCycleElement extends AuthorBaseElement(HTMLElement) {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineProperties({\n      dummyEl: {\n        private: true,\n        readonly: true,\n        default: document.createElement('div')\n      },\n\n      /**\n       * @typedef {Object} SelectedElementProperties\n       * @property {HTMLElement} element The currently selected page.\n       * @property {Number} index The zero-based index of the currently selected page.\n       */\n\n      /**\n       * @property selected\n       * Get information about the currently selected element.\n       * @return {SelectedElementProperties}\n       */\n      selected: {\n        readonly: true,\n        get: () => ({\n          element: this.selectedElement,\n          index: this.selectedIndex\n        })\n      },\n\n      /**\n       * @property selectedElement\n       * The currently selected element.\n       * @return {HTMLElement}\n       */\n      selectedElement: {\n        readonly: true,\n        get: () => this.selectedIndex === null ? null : this.children.item(this.selectedIndex)\n      },\n\n      /**\n       * @property selectedIndex\n       * The zero-based index of the currently selected element.\n       * @return {Number}\n       */\n      selectedIndex: {\n        readonly: true,\n        get: () => {\n          for (let index in this.children) {\n            if (!this.children.hasOwnProperty(index)) {\n              continue\n            }\n\n            let child = this.children.item(index)\n\n            if (typeof child !== 'object') {\n              continue\n            }\n\n            if (child.hasAttribute('selected')) {\n              return parseInt(index)\n            }\n          }\n\n          return null\n        }\n      }\n    })\n\n    this.UTIL.definePrivateMethods({\n      getChildIndex: child => [...this.children].indexOf(child),\n\n      getNextSelectedChild: child => {\n        let nextIndex = this.PRIVATE.getChildIndex(child)\n\n        return {\n          element: child,\n          index: nextIndex\n        }\n      },\n\n      hideChild: child => child.removeAttribute('selected', ''),\n\n      handleChange: (child, previousSelection) => {\n        if (this.selectedIndex >= 0) {\n          this.PRIVATE.hideChild(this.children.item(this.selectedIndex || 0))\n        }\n\n        child.setAttribute('selected', '')\n\n        this.dispatchEvent(new CustomEvent('change', {\n          bubbles: true,\n          cancelable: true,\n          composed: true,\n\n          detail: {\n            previousSelection,\n            currentSelection: this.selected\n          }\n        }))\n      },\n\n      showChild: child => {\n        let {\n          handleChange,\n          getNextSelectedChild,\n          hideChild\n        } = this.PRIVATE\n\n        let previousSelection = this.selected\n        let nextSelection = getNextSelectedChild(child)\n\n        let beforechange = {\n          event: new CustomEvent('beforechange', {\n            bubbles: true,\n            cancelable: true,\n            composed: true,\n\n            detail: {\n              currentSelection: this.selected,\n              nextSelection\n            }\n          }),\n\n          handler: evt => {\n            this.off('beforechange', beforechange.handler)\n\n            if (evt.defaultPrevented) {\n              return\n            }\n\n            handleChange(child, previousSelection)\n          }\n        }\n\n        this.on('beforechange', beforechange.handler)\n\n        beforechange.event.detail.next = (function () {\n          if (!this.defaultPrevented) {\n            return this.UTIL.printToConsole(`Calling \"next()\" in \"beforechange\" event handler will have no effect unless the event's default behavior is canceled. (use Event.preventDefault())`, 'warning')\n          }\n\n          handleChange(child, previousSelection)\n        }).bind(beforechange.event)\n\n        this.dispatchEvent(beforechange.event)\n      },\n\n      showChildByIndex: index => {\n        if (this.selectedIndex === index || index >= this.children.length || index < 0) {\n          return\n        }\n\n        this.PRIVATE.showChild(this.children.item(index))\n      },\n\n      showChildBySelector: query => {\n        let nodes = this.querySelectorAll(query)\n\n        if (!nodes.length) {\n          return this.UTIL.printToConsole(`Node matching query \"${query}\" not found. Aborting...`, 'warning')\n        }\n\n        if (nodes.length > 1) {\n          this.UTIL.printToConsole(`Found multiple nodes matching \"${query}\". Displaying first result...`, 'warning')\n        }\n\n        this.PRIVATE.showChild(nodes.item(0))\n      }\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => {\n        this.UTIL.monitorChildren(mutations => {\n          mutations.forEach(mutation => {\n            let { addedNodes, removedNodes, type } = mutation\n\n            switch (type) {\n              case 'childList':\n                if (removedNodes.length > 0 && !this.selectedElement) {\n                  return this.previous()\n                }\n\n                break\n            }\n          })\n        })\n      },\n\n      rendered: () => {\n        for (let index in this.children) {\n          if (!this.children.hasOwnProperty(index)) {\n            continue\n          }\n\n          let child = this.children.item(index)\n\n          if (typeof child !== 'object') {\n            continue\n          }\n\n          if (child !== this.selectedElement) {\n            this.PRIVATE.hideChild(child)\n          }\n        }\n      }\n    })\n  }\n\n  static get observedAttributes () {\n    return ['mode']\n  }\n\n  /**\n   * @method hideAll\n   * Deactivate all pages.\n   */\n  hideAll () {\n    for (let index in this.children) {\n      if (!this.children.hasOwnProperty(index)) {\n        continue\n      }\n\n      let child = this.children.item(index)\n\n      if (typeof child !== 'object') {\n        continue\n      }\n\n      this.PRIVATE.hideChild(child)\n    }\n  }\n\n  indexOf (child) {\n    return this.PRIVATE.getChildIndex(child)\n  }\n\n  /**\n   * @method insertAdjacentHTML\n   * Override this.prototype.insertAdjacentHTML and replace with\n   * appendChild() or insertBefore()\n   * This is done because of bugs with insertAdjacentHTML() on web components\n   * in Firefox and IE11.\n   * @override\n   */\n  insertAdjacentHTML (position, text) {\n    switch (position) {\n      case 'beforebegin':\n      case 'afterend':\n        return HTMLElement.prototype.insertAdjacentHTML.call(this, position, text)\n\n      default:\n        let { dummyEl } = this.PRIVATE\n\n        dummyEl.insertAdjacentHTML(position, text)\n        let node = dummyEl.children.item(0)\n\n        while (dummyEl.firstChild) {\n          dummyEl.removeChild(dummyEl.firstChild)\n        }\n\n        return position === 'beforeend' ? this.appendChild(node) : this.insertBefore(node, this.firstElementChild)\n    }\n  }\n\n  /**\n   * @method insertAdjacentElement\n   * Override this.prototype.insertAdjacentElement and replace with\n   * appendChild() or insertBefore()\n   * This is done because of bugs with insertAdjacentElement() on web components\n   * in Firefox and IE11.\n   * @param {string} position (beforebegin, afterbegin, beforeend, afterend)\n   * @param {HTMLElement} node\n   * Node to which to insert adjacent HTML\n   * @override\n   */\n  insertAdjacentElement (position, node) {\n    switch (position) {\n      case 'beforeend': return this.appendChild(node)\n      case 'afterbegin': return this.insertBefore(node, this.firstElementChild)\n      default: return HTMLElement.prototype.insertAdjacentElement.call(this, position, node)\n    }\n  }\n\n  /**\n   * @method first\n   * A helper method to display the first child element.\n   */\n  first () {\n    this.show(0)\n  }\n\n  /**\n   * @method last\n   * A helper method to display the last child element.\n   */\n  last () {\n    this.show(this.children.length - 1)\n  }\n\n  /**\n   * @method next\n   * Deactivate the currently selected child element and activate the one\n   * immediately adjacent to it.\n   * @param {function} callback\n   * Executed when the operation is complete.\n   */\n  next (callback) {\n    this.show(this.selectedIndex === this.children.length - 1 ? 0 : this.selectedIndex + 1)\n    callback && callback(this.selectedElement)\n  }\n\n  /**\n   * @method previous\n   * Deactivate the currently selected child element and activate the one\n   * immediately preceding it.\n   * @param {function} callback\n   * Executed when the operation is complete.\n   */\n  previous (callback) {\n    this.show(this.selectedIndex === 0 ? this.children.length - 1 : this.selectedIndex - 1)\n    callback && callback(this.selectedElement)\n  }\n\n  /**\n   * @method show\n   * Deselect the currently selected element and select a different one.\n   * @param {number | string | HTMLElement} query\n   * 1-based index,\n   * Element selector string, or\n   * HTMLElement to select\n   */\n  show (query) {\n    if (query === null) {\n      if (!this.selectedIndex) {\n        this.PRIVATE.showChildByIndex(0)\n      }\n\n      return\n    }\n\n    switch ((typeof query).toLowerCase()) {\n      case 'number': return this.PRIVATE.showChildByIndex(query)\n\n      case 'string':\n        let int = parseInt(query)\n\n        return isNaN(int)\n          ? this.PRIVATE.showChildBySelector(query)\n          : this.PRIVATE.showChildByIndex(int)\n\n      default: return query instanceof HTMLElement\n        ? this.PRIVATE.showChild(query)\n        : this.UTIL.throwError({\n          type: 'reference',\n          message: `Invalid query \"${query}\"`\n        })\n    }\n  }\n}\n\ncustomElements.define('author-cycle', AuthorCycleElement)\n\nexport default AuthorCycleElement\n"],"names":["AuthorCycleElement","AuthorBaseElement","HTMLElement","[object Object]","super","this","UTIL","defineProperties","dummyEl","private","readonly","default","document","createElement","selected","get","element","selectedElement","index","selectedIndex","children","item","hasOwnProperty","child","hasAttribute","parseInt","definePrivateMethods","getChildIndex","indexOf","getNextSelectedChild","PRIVATE","hideChild","removeAttribute","handleChange","previousSelection","setAttribute","dispatchEvent","CustomEvent","bubbles","cancelable","composed","detail","currentSelection","showChild","nextSelection","beforechange","event","handler","evt","off","defaultPrevented","on","next","printToConsole","bind","showChildByIndex","length","showChildBySelector","query","nodes","querySelectorAll","registerListeners","connected","monitorChildren","mutations","forEach","mutation","addedNodes","removedNodes","type","previous","rendered","observedAttributes","position","text","prototype","insertAdjacentHTML","call","node","firstChild","removeChild","appendChild","insertBefore","firstElementChild","insertAdjacentElement","show","callback","toLowerCase","int","isNaN","throwError","message","customElements","define"],"mappings":"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"}